<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Любой заголовок</title>
    <style>
        body {
            color: #f92672;
            background: #272822; 
        }
        .odd h2 {
            color: pink;
        }
        .even h2 {
            color:blue;
        }
        .even {
            background: linear-gradient(#f6f6f6, #ff72dc);
        }
        .odd {
            background: linear-gradient(blue, #f6f6f6);
        }
        img {
            width: 30vw;
        }
        .strong {
            font-weight:bold;
        }
        .italic {
            font-style:italic;
        }
        .strike {
            text-decoration: line-through;
        }
        table, td {
            border:#272822 solid 2px;
        }
        table {
            border-collapse: collapse;
            margin: 0 0 0 50px;
        }
        td {
            padding: 15px;
            text-align: center;
        }
        #wrapper {
            font-size: 13px;
        }
        #wrapper table, #wrapper tr, #wrapper th, #wrapper td {
            border: 1px black solid;
            padding: 3px;
        }
        .vacation {
            background-color: aquamarine;
        }
    </style>
</head>
<body>


    <h1>Моя первая страница</h1>
    <div class="odd" id="ball">
        <h2>Мячик</h2>
        <span class="strong">Наша Таня громко плачет:</span> <br>
        <span class="italic">Уронила в речку мячик.</span> <br>
        <span>-Тише, Танечка, не плачь:</span> <br>
        <span class="strike">Не утонет в речке мяч.</span> <br>
        <span class="strong italic">Автор А.Л. Барто</span>
    </div>
    <div class="even" id="mems">
        <h2>Весёлые картинки</h2>
        <img src="img/images.jpg" alt="smiles">
        <img src="img/images2.jpg" alt="smiles" srcset="">
        <img src="img/full.jpg" alt="smiles" srcset="">
        <img src="img/standart.jpg" alt="smiles" srcset="">
        <img src="img/vertical.jpg" alt="smiles" srcset="">
    </div>
    <div class="odd" id="schedule">
        <h2>Расписание звонков</h2>
        <ol>
            <li>08:20 - 09:50</li>
            <li>10:00 - 11:30</li>
            <ul style="list-style-type: disc;">
                <li>Перемена 40 минут</li>
            </ul>
            <li>12:10 - 13:40</li>
            <li>13:50 - 15:20</li>
            <li>15:30 - 17:00</li>
            <ul style="list-style-type: disc;">
                <li>Перемена 20 минут</li>
            </ul>
            <li>17:20 - 18:50</li>
            <li>19:00 - 20:30</li>
        </ol>
    </div>
    <div class="even" id="timetable">
        <h2>Расписание пар</h2>
        <table>
            <thead>
                <tr>
                    <td>Номер пары</td>
                    <td>Название предмета</td>
                    <td>Аудитория</td>
                    <td>Преподаватель</td>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>1</td>
                    <td>Теория чисел</td>
                    <td>223/4к</td>
                    <td>Мерзляков А.С.</td>
                </tr>
                <tr>
                    <td>2</td>
                    <td>Теория чисел</td>
                    <td>223/4к</td>
                    <td>Мерзляков А.С.</td>
                </tr>
                <tr>
                    <td>3</td>
                    <td>Параллельное программирование</td>
                    <td>222/4к</td>
                    <td>Новиков А.К.</td>
                </tr>
                <tr>
                    <td>4</td>
                    <td>Финансовая математика</td>
                    <td>223/4к</td>
                    <td>Банщикова И.Н.</td>
                </tr>
                <tr>
                    <td>5</td>
                    <td>Финансовая математика</td>
                    <td>222/4к</td>
                    <td>Банщикова И.Н.</td>
                </tr>
            </tbody>
        </table>
    </div>
    <div class="odd" id="diary">
        <h2>Дневник</h2>
        <form action="" method="post">
            <div>
                <p><label for="fio">Фамилия, имя, отчество</label></p>
                <input id="fio" type="text" value="Иванцов Данил Игоревич">
            </div>
            <div>
                <p><label for="gender">Пол</label></p>
                <label for="man">Мужской</label> <input id="man" name="gender" type="radio" value="M" checked>
                <label for="woman">Женский</label> <input id="woman" name="gender" type="radio" value="F">
            </div>
            <div>
                <p><label for="school">Школа</label></p>
                <input id="school" type="text" value="СОШ №48">
            </div>
            <div>
                <p><label for="locality">Населенный пункт</label></p>
                <input id="locality" type="text" value="Ижевск">
            </div>
            <div>
                <p><label for="class">Класс</label></p>
                <input id="class" type="text" value="12">
            </div>
            <div>
                <label for="colorObl">Цвет обложки</label>
                <input id="colorObl" type="color" value="#FFFF00">
            </div>
            <div>
                <label for="year">Год начала учебного года</label>
                <input id="year" type="number" value="2025">
            </div>
            <div>
                <label for="email">Email</label>
                <input id="email" type="email" value="email@email">
            </div>
            <div>
                <label for="phone">Телефон</label>
                <input id="phone" type="phone" value="111111111111">
            </div>
            <div>
                <p><input type="submit" id="create" value="Создать"></p>
            </div>

        </form>
    </div>
    <div class="even" id="accounting">
        <h2>Бухгалтерия</h2>
        <div id="wrapper"></div> 
    </div>
    <script>
        console.log('Hello world!');
        let employees = [
            {
                "surname": 'Иванов', //Фамилия
                "name": 'Иван', //Имя
                "patronymic": 'Иванович', //Отчество 
                "birthday": '1987-11-30', //Дата рождения в формате ГГГГ-ММ-ДД
                "experience": 5, //Стаж работы
                "salary": 48200, //Зарплата гросс в месяц
                "salary13": 3000, //Годовая премия
                "gender": 'm', //Премия
                "vacation": 0, //Месяц отпуска
            },
            {
                "surname": 'Петров', 
                "name": 'Петр', 
                "patronymic": 'Петрович', 
                "birthday": '2001-01-01',
                "experience": 0,
                "salary": 27600,
                "salary13": 1000,
                "gender": 'm',
                "vacation": 8,
            },
            {
                "surname": 'Капустина', 
                "name": 'Ирина', 
                "patronymic": 'Николаевна', 
                "birthday": '1992-02-02',
                "experience": 4,
                "salary": 36000,
                "salary13": 4000,
                "gender": 'f',
                "vacation": 3,
            },
            {
                "surname": 'Билл', 
                "name": 'Гейтс', 
                "patronymic": '', 
                "birthday": '1955-10-28',
                "experience": 1,
                "salary": 16900,
                "salary13": 100,
                "gender": 'm',
                "vacation": 11,
            },
            {
                "surname": 'Ложкина', 
                "name": 'Галина', 
                "patronymic": 'Ильинична', 
                "birthday": '2002-01-13',
                "experience": 1,
                "salary": 80000,
                "salary13": 100000,
                "gender": 'f',
                "vacation": 6,
            },
            {
                "surname": 'Матрос', 
                "name": 'Капитолия', 
                "patronymic": 'Владовна', 
                "birthday": '1975-04-20',
                "experience": 20,
                "salary": 90000,
                "salary13": 4000,
                "gender": 'f',
                "vacation": 7,
            },
            {
                "surname": 'Елисейская', 
                "name": 'Италия', 
                "patronymic": 'Франсовна', 
                "birthday": '1999-08-12',
                "experience": 3,
                "salary": 36700,
                "salary13": 4000,
                "gender": 'f',
                "vacation": 4,
            },
            {
                "surname": 'Строгая', 
                "name": 'Лада', 
                "patronymic": '', 
                "birthday": '1990-08-15',
                "experience": 7,
                "salary": 69000,
                "salary13": 3600,
                "gender": 'f',
                "vacation": 9,
            },
            {
                "surname": 'Император', 
                "name": 'Павел', 
                "patronymic": 'Григорьевич', 
                "birthday": '1970-12-19',
                "experience": 7,
                "salary": 28999,
                "salary13": 3900,
                "gender": 'm',
                "vacation": 1,
            },
            {
                "surname": 'Ватрушкин', 
                "name": 'Петр', 
                "patronymic": 'Семенович', 
                "birthday": '2000-05-13',
                "experience": 1,
                "salary": 200000,
                "salary13": 0,
                "gender": 'm',
                "vacation": 5,
            },
        ];
        function calculateNetSalary(salary) {
            return +(salary*1.15*.87).toFixed(2);
        }

        function calculateYearSalary(salary, salary13) {
            return +(12*salary + 0.87*salary13).toFixed(2);
        }

        function calculateTaxReturn(yearSalary) {
            return Math.round(.13 * yearSalary);
        }

        function calculateNewSalary(salary) {
            return +(1.078 * salary).toFixed(2);
        }

        function calculateAge(birthday) {
            let today = new Date();
            let age = new Date(birthday);
            let year = today.getFullYear() - age.getFullYear();
            let month = today.getMonth() - age.getMonth();
            if(month < 0) {
                month += 12;
                year -= 1;
            }
            return [year, month];
        }
        
        function remainsToPension(gender, age) {
            const [year, month] = age;
            const months = gender === 'm' ? 64*12 : 59*12;
            const remainsMonth = months - year*12 + month;
            if(remainsMonth < 0) return [null, null];
            if(remainsMonth % 12 === 0) return [remainsMonth/12, 0];
            return [Math.floor(remainsMonth/12), 12 - remainsMonth % 12];
        }

        function newFormatOfBirthday(birthday, months) {
            const tempDate = new Date(birthday);
            return `${tempDate.getDate()}.${months[tempDate.getMonth()][1]}.${tempDate.getFullYear()}`;
        }

        function ageCase(age) {
            if(age%10 === 1 && age%100 !== 11) {
                return 'год';
            }
            if(
                (age%10 === 2 || age%10 === 3 || age%10 === 4) && 
                age%100 !== 14 && age%100 !== 12 && age%100 !== 13
            ) {
                return 'года';
            }
            return 'лет';
        }

        const months = [
            ['Январь', 'января'],
            ['Февраль', 'февраля'],
            ['Март', 'марта'],
            ['Апрель', 'апреля'],
            ['Май', 'мая'],
            ['Июнь', 'июня'],
            ['Июль', 'июля'],
            ['Август', 'августа'],
            ['Сентябрь', 'сентября'],
            ['Октябрь', 'октября'],
            ['Ноябрь', 'ноября'],
            ['Декабрь', 'декабря'],
        ];

        let table = `<table><thead>
            <tr>
                <th>№</th>
                <th>ФИО</th>
                <th>Дата рождения</th>
                <th>Возраст</th>
                <th>Зарплата гросс.</th>
        `;

        for(let i = 0; i < 12; i++) {
            table += `<th>${months[i][0]}</th>`;
        }
        table += `<th>Зарплата в ${new Date().getFullYear()+1}</th>
            <th>Общий доход</th>
            <th>К вычету</th>
            <th>Ост. до пенсии</th>
        </tr>
        </thead>
        <tbody>`;
        const rub = "&#x20bd";
        for(let i in employees) {
            item = employees[i];
            [ageYear, ageMonth] = calculateAge(item.birthday);
            [rtpYear, rtpMonth] = remainsToPension(item.gender, [ageYear, ageMonth]);
            table += `<tr>
                <td>${+i+1}</td>
                <td>${item.surname} ${item.name} ${item.patronymic}</td>
                <td>${newFormatOfBirthday(item.birthday, months)}</td>
                <td>${ageYear} ${ageCase(ageYear)}</td>
                <td>${item.salary}${rub}</td>`
            let ys = calculateYearSalary(item.salary, item.salary13);
            for(let j = 0; j < 11; j++) {
                table += `<td ${j===item.vacation ? 'class=vacation' : ''}>${calculateNetSalary(item.salary)}${rub}</td>`;
            }
            table += `<td ${11===item.vacation ? 'class=vacation' : ''}>${calculateNetSalary(item.salary)+calculateNetSalary(item.salary13)}${rub}</td>
                <td>${calculateNewSalary(item.salary)}${rub}</td>
                <td>${ys}${rub}</td>
                <td>${calculateTaxReturn(ys)}${rub}</td>
                <td>${rtpYear !== null ? (rtpYear + ageCase(rtpYear)) : "Уже на пенсии"}</td>
            `;

            table += `</tr>`;
        }

        table += `</tbody></table>`;

        window.onload = () => {
            document.querySelector("#wrapper").innerHTML = table;

            document.querySelector("#create").onclick = (e) => {
                e.preventDefault();
                let newWin = window.open("about:blank", "Дневник", "width=420,height=594");
                let template = `
                <style>
                    body {
                        color: purple;
                        margin-top: 100px;
                        text-align: center;
                        font-size: large;
                        background-color: ${document.querySelector('#colorObl').value}
                    }
                    .contact {
                        margin-top: 50px;
                    }

                </style>
                <h1>Дневник</h1>
                <div>Учени${document.querySelector('[name="gender"]:checked').value == "M" ? "к" : "ца"} 
                    ${document.querySelector("#class").value} класса </div>
                    <div>${document.querySelector("#school").value} ${document.querySelector("#locality").value}</div>
                    <div>${document.querySelector("#fio").value}</div>
                    <div>${document.querySelector("#year").value}/${+document.querySelector("#year").value+1} учебного года</div>
                    <div class='contact'>${document.querySelector("#email").value}, ${document.querySelector("#phone").value}</div>


                </div>
                `;
                newWin.document.write(template);
            }


        }
        
    </script>


</body>
</html>